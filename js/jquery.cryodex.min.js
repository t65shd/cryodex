!function(t,e,a,r){function s(e,a){this.element=e,t("body").append('<div id="cryodex-js-colour-config"></div>'),colours=jQuery.parseJSON(t("#cryodex-js-colour-config").css("content").replace(/"/g,"").replace(/'/g,'"')),"object"==typeof colours?o.colours=colours:o.colours=o.baseColours,this.options=t.extend({},o,a),this._defaults=o,this._name=n,this._counter=0,this.init()}var n="cryodex",o={baseColours:{first:"#1abc9c",second:"#e74c3c",third:"#3498db",fourth:"#9b59b6",fifth:"#34495e",sixth:"#2ecc71",seventh:"#e67e22",eighth:"#f1c40f",ninth:"#7f8c8d",tenth:"#d35400"},legend:{}};s.prototype={init:function(){switch(t(this.element).attr("data-cryodex-widget")){case"gauge":this._gauge();break;case"doughnut":this._doughnut();break;case"bar":this._bar("bar");break;case"horizontal-bar":this._bar("horizontalBar");break;case"line":this._line();break;case"progress":this._progress()}t(this.element).addClass("cryodex-loaded")},_getColour:function(t){return"undefined"==typeof t||""==t?t=this.options.colours[Object.keys(this.options.colours)[this._counter%Object.keys(this.options.colours).length]]:"undefined"!=typeof this.options.colours[t]?t=this.options.colours[t]:"undefined"!=typeof this._defaults.baseColours[t]&&(t=this._defaults.baseColours[t]),t},_getColourAlpha:function(t,e){return t=this._getColour(t),"rgba("==t.substr(0,5)?(rgb=t.replace("rgba(","").replace(")",""),rgb=rgb.split(","),t="rgba("+rgb[0]+","+rgb[1]+","+rgb[2]+","+e+")"):"rgb("==t.substr(0,4)?(rgb=t.replace("rgb(","").replace(")",""),rgb=rgb.split(","),t="rgba("+rgb[0]+","+rgb[1]+","+rgb[2]+","+e+")"):/^#([A-Fa-f0-9]{3}){1,2}$/.test(t)&&(c=t.substring(1).split(""),3==c.length&&(c=[c[0],c[0],c[1],c[1],c[2],c[2]]),c="0x"+c.join(""),t="rgba("+[c>>16&255,c>>8&255,255&c].join(",")+","+e+")"),t},_gauge:function(){this._counter=0;var a=.75*t(this.element).attr("data-percent"),r=75-a,s=this._getColour(t(this.element).attr("data-colour"));t(this.element).append("<canvas />"),this.chart=new Chart(t("canvas",this.element),{type:"doughnut",responsive:!0,data:{labels:["Complete",null],datasets:[{label:"progress",data:[a,r,25],backgroundColor:[s,"#ddd","transparent"],hoverBackgroundColor:[s,"#ddd","transparent"],borderWidth:0}]},options:{legend:{display:!1},tooltips:{enabled:!1},cutoutPercentage:70,rotation:.75*Math.PI,onClick:e[t(this.element).attr("data-click")]}})},_doughnut:function(){var a=this;a._counter=0;var r=t("table",this.element).eq(0).hide(),s=new Array;t("thead th",r).each(function(){s.push(t(this).text())});var n=new Array;t("tbody tr",r).each(function(){var e=new Object;e.label=t(this).attr("data-label"),e.data=new Array,e.backgroundColor=new Array,t("td",this).each(function(){e.data.push(t(this).text()),e.backgroundColor.push(a._getColour(t(this).attr("data-colour"))),a._counter++}),e.borderWidth=0,n.push(e)});var o=this.options.legend;o.display=!1,t(this.element).attr("data-legend-click")&&(o.onClick=e[t(this.element).attr("data-legend-click")]),t(this.element).append('<div class="cryodex-chart-wrapper"><div class="cryodex-legend" /><div class="cryodex-chart"><canvas /></div></div>'),this.chart=new Chart(t("canvas",this.element),{type:"doughnut",responsive:!0,data:{labels:s,datasets:n},options:{legend:o,onClick:e[t(this.element).attr("data-click")],legendCallback:function(e){console.log(e.data);var r=[];r.push("<ul>");for(var s=0;s<e.data.datasets[0].data.length;s++)r.push("<li>"),console.log(t(a.element).attr("data-legend-click")),t(a.element).attr("data-legend-click")&&r.push('<a href="javascript:'+t(a.element).attr("data-legend-click")+"(null, {index: "+s+", text: '"+e.data.labels[s]+"'});\">"),r.push('<span style="background-color:'+e.data.datasets[0].backgroundColor[s]+'">&nbsp;</span>'),e.data.labels[s]&&r.push(e.data.labels[s]),t(a.element).attr("data-legend-click")&&r.push("</a>"),r.push("</li>");return r.push("</ul>"),r.join("")}}}),t(".cryodex-legend",this.element).html(this.chart.generateLegend())},_bar:function(a){var r=this;r._counter=0;var s=t("table",this.element).eq(0).hide(),n=new Array;t("thead th",s).each(function(){n.push(t(this).text())});var o=new Array;t("tbody tr",s).each(function(){var e=new Object;e.label=t(this).attr("data-label"),e.data=new Array,e.backgroundColor=new Array,t("td",this).each(function(){e.data.push(t(this).text()),e.backgroundColor.push(r._getColour(t(this).attr("data-colour"))),r._counter++}),e.borderWidth=0,o.push(e)});var i={legend:{display:!1},onClick:e[t(this.element).attr("data-click")]};t(this.element).attr("data-stacked")&&(i.scales={xAxes:[{stacked:!0}],yAxes:[{stacked:!0}]}),t(this.element).append("<canvas />"),this.chart=new Chart(t("canvas",this.element),{type:a,responsive:!0,data:{labels:n,datasets:o},options:i})},_line:function(){var a=this;a._counter=0;var r=t("table",this.element).eq(0).hide(),s=new Array;t("thead th",r).each(function(){s.push(t(this).text())});var n=new Array;t("tbody tr",r).each(function(){var e=new Object;e.label=t(this).attr("data-label"),e.data=new Array,e.pointRadius=3,e.pointHoverRadius=5;var r=a._getColour(t(this).attr("data-colour"));e.pointBackgroundColor=r,e.borderColor=r,e.pointBorderColor="#fff",e.pointHitRadius=20,"undefined"!=typeof t(this).attr("data-fill")&&(e.backgroundColor=a._getColourAlpha(t(this).attr("data-colour"),.6)),t("td",this).each(function(){e.data.push(t(this).text())}),n.push(e),a._counter++}),t(this.element).append("<canvas />"),this.chart=new Chart(t("canvas",this.element),{type:"line",responsive:!0,data:{labels:s,datasets:n},options:{legend:{display:!1},tooltips:{mode:"x-axis"},hover:{mode:"x-axis"},onClick:e[t(this.element).attr("data-click")]}})},_progress:function(){t(this.element).attr("data-value",t(this.element).html())}},t.fn[n]=function(e){return t("[data-cryodex-widget]",this).each(function(){t.data(this,"plugin_"+n)||t.data(this,"plugin_"+n,new s(this,e))})}}(jQuery,window,document);